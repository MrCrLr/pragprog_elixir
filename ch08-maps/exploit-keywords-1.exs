defmodule Exploit do
  @defaults [
    target: [
      baseurl: "fun.com",
      endpoint: "toys?productid=",
    ],

    payload: [
      type: :sql_injection,
      style: []
    ],

    runtime: [
      workers: 1,
      timeout: 3000
    ]
  ]

  def proof(name, opts \\ []) do
    opts = Keyword.merge(@defaults, opts)

    IO.puts "Running PoC: #{inspect(name)}"

    IO.inspect opts[:target], label: "Target"
    IO.inspect opts[:payload], label: "Payload"
    IO.inspect opts[:runtime], label: "Runtime"
  end
end

Exploit.proof(
  "cve-xxx-xxxx",
  target: [baseurl: "example.com"],
  runtime: [workers: 10],
  payload: [style: [:bruteforce, :throttle]]
)
